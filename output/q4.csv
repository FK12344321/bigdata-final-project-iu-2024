0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team23_projectdb; 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.resultset.use.unique.column.names = false;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS q4_results;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE q4_results (
. . . . . . . . . . . . . . . . . . . . . . .>   host_identity_verified BOOLEAN, 
. . . . . . . . . . . . . . . . . . . . . . .>   count INT,
. . . . . . . . . . . . . . . . . . . . . . .>   avg_number_of_reviews DOUBLE
. . . . . . . . . . . . . . . . . . . . . . .> ) ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY ',' 
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION 'project/warehouse/q4';
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO q4_results 
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> SELECT host_identity_verified, COUNT(*) as count, AVG(number_of_reviews)  as avg_number_of_reviews
. . . . . . . . . . . . . . . . . . . . . . .> FROM airbnb_part_buck
. . . . . . . . . . . . . . . . . . . . . . .> GROUP BY host_identity_verified;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM q4_results;
+-------------------------+--------+------------------------+
| host_identity_verified  | count  | avg_number_of_reviews  |
+-------------------------+--------+------------------------+
| NULL                    | 188    | 19.0531914893617       |
| true                    | 49748  | 25.18442952480502      |
| false                   | 24175  | 12.099482936918305     |
+-------------------------+--------+------------------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 